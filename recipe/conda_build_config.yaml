# https://conda-forge.org/docs/maintainer/knowledge_base/#requiring-newer-macos-sdks
MACOSX_SDK_VERSION:  # [osx and x86_64]
  - 11.0            # [osx and x86_64]
MACOSX_DEPLOYMENT_TARGET:  # [osx and x86_64]
  - "11.0"                # [osx and x86_64]
channel_sources:
  - tiledb/label/for-cloud,conda-forge,tiledb  # [linux]
  - conda-forge,tiledb
channel_targets:
  - tiledb main
channel_priority:
  - strict
# conda-forge has migrated to fmt 10 and spdlog 1.12. We need fmt 9 to install
# into our existing TileDB Cloud conda environments, so we build a special
# variant of fmt 9 and spdlog 1.11. And because this can no longer solve with
# conda-forge depedencies, we install the "for-cloud" tiledb binary from
# tiledb/label/for-cloud
fmt:                 # [linux]
  - 9                # [linux]
  - 10               # [linux]
spdlog:              # [linux]
  - 1.11             # [linux]
  - 1.13             # [linux]
zip_keys:            # [linux]
  - channel_sources  # [linux]
  - fmt              # [linux]
  - spdlog           # [linux]
# Because of the awkwardness required for the cloud variant above
# (fmt9+spdlog1.11), we have to migrate the osx-* manually here. Once the
# conda-forge-pinning-feedstock is updated to spdlog 1.13, we can remove the
# manual pin below
spdlog:              # [not linux]
  - 1.13             # [not linux]
# The below prevents a Python 3.12 variant for the osx-* builds. We can't build
# tiledbsoma-py for Python 3.12 on osx-* until the AWS/S3 problem introduced in
# pyarrow 13 is resolved
# https://github.com/single-cell-data/TileDB-SOMA/issues/1926#issuecomment-1834695149
python:               # [osx]
  - 3.8.* *_cpython   # [osx]
  - 3.9.* *_cpython   # [osx]
  - 3.10.* *_cpython  # [osx]
  - 3.11.* *_cpython  # [osx]
python_impl:          # [osx]
  - cpython           # [osx]
  - cpython           # [osx]
  - cpython           # [osx]
  - cpython           # [osx]
numpy:                # [osx]
  - 1.22              # [osx]
  - 1.22              # [osx]
  - 1.22              # [osx]
  - 1.23              # [osx]
